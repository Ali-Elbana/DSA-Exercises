
**Video explanation by AI:** [Watch the video here](https://notebooklm.google.com/notebook/68a51878-3ce2-4a6e-ba12-62bb4ec9e31e?artifactId=cd16570b-decf-4ad3-9957-d72eafd569f9)

---

The `balance` method in the Binary Search Tree implementation is designed to transform a potentially skewed tree into a balanced one, which can improve the efficiency of tree operations.

[![BST](G:\DSA\Slides\BST-Balance\s1.png)

**The code reference:** [[9.3.2-Binary Search Tree â€“ Balance - Code#Complete Code Implementation]]

---
Here's a breakdown of the `balance` method and its helpers:

- **Purpose of Balancing**
    
    - The primary goal is to take a binary search tree, which might be "skewed" (like a linked list) due to the order of insertions, and reconfigure it into a more balanced structure. A balanced tree ensures more efficient search, insertion, and deletion operations.
    - The visualization in the sources clearly shows turning a right-skewed tree (elements 1 through 7 inserted in ascending order) into a balanced tree where '4' is the root.
- **The `balance()` Method Steps**
    
    - If the tree is already empty, it prints a message stating it's "already empty (balanced)!" and returns.
    - Otherwise, it announces that it's "Balancing the tree...".
    - **Step 1: Collect Data in Sorted Order**
        - A `std::vector` named `sortedData` is created to hold the tree's elements.
        - The **`collectInOrder`** helper method (or `InorderToArray` as per the pseudo-code) is called to traverse the existing tree in **in-order traversal**.
        - During this traversal, all node data is collected and pushed into the `sortedData` vector. An in-order traversal of a Binary Search Tree naturally produces elements in sorted ascending order.
    - **Step 2: Destroy the Old Tree**
        - After collecting all data, the original tree structure is completely **destroyed** by calling the **`destroyTree`** method with the current `root`.
        - The `destroyTree` method is a recursive post-order traversal that deallocates memory for each node, ensuring no memory leaks.
    - **Step 3: Build a New Balanced Tree**
        - The `root` of the `BinaryTree` is then set by calling the **`buildBalancedTree`** helper method (or `recursiveBalance` as per the pseudo-code).
        - This helper constructs a new tree from the `sortedData` vector.
- **The `buildBalancedTree` Helper Method**
    
    - This method (or `recursiveBalance` in the pseudo-code) takes the `sortedData` vector, a `start` index, an `end` index, and a `parent` node pointer as arguments.
    - **Base Case:** If `start` is greater than `end`, it means there are no elements to process in the current sub-array, so it returns `nullptr`.
    - **Finding the Middle:** It calculates the **middle index (`mid`)** of the current segment of the `sortedData` array.
        - The formula used is `int mid = start + (end - start) / 2;`.
    - **Creating the Node:** A new `TreeNode` is created using the data at the `mid` index from `sortedData`. This new node becomes the root of the current subtree.
    - **Setting Parent Pointer:** The `Parent` pointer of the `newNode` is set to the `parent` argument passed to the function.
    - **Recursive Calls:**
        - It **recursively builds the left subtree** by calling `buildBalancedTree` with the `sortedData`, `start` to `mid - 1` (elements before the middle), and passing the `newNode` as the parent.
        - It **recursively builds the right subtree** by calling `buildBalancedTree` with the `sortedData`, `mid + 1` to `end` (elements after the middle), and passing the `newNode` as the parent.
    - Finally, it returns the `newNode` (the root of the balanced subtree).
- **Result**
    
    - After these steps, the `balance()` method prints "Tree has been balanced successfully!".
    - The `main` application demonstrates this by inserting skewed data (1-7), printing the original skewed tree, then calling `balance()`, and printing the resulting balanced tree.


[![BST](G:\DSA\Slides\BST-Balance\s2.png)

[![BST](G:\DSA\Slides\BST-Balance\s3.png)

[![BST](G:\DSA\Slides\BST-Balance\s4.png)

---